<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.3.1"/>
    <title>trinamic850 API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#TrinamicBoard">TrinamicBoard</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TrinamicBoard.__init__">TrinamicBoard</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.connect">connect</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.exchange_command">exchange_command</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.z_ustep2um">z_ustep2um</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.z_um2ustep">z_um2ustep</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.zhome">zhome</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.xy_ustep2um">xy_ustep2um</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.xy_um2ustep">xy_um2ustep</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.xyhome">xyhome</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.t_ustep2deg">t_ustep2deg</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.t_deg2ustep">t_deg2ustep</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.thome">thome</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.tmove">tmove</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.move">move</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.target_pos">target_pos</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.current_pos">current_pos</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.move_abs_pos">move_abs_pos</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.move_rel_pos">move_rel_pos</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.home_status">home_status</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.target_status">target_status</a>
                        </li>
                        <li>
                                <a class="function" href="#TrinamicBoard.reference_status">reference_status</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
trinamic850    </h1>

                        <div class="docstring"><p>MIT License</p>

<p>Copyright (c) 2020 Etaluma, Inc.</p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyribackground_downght notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>

<pre><code>
</code></pre>

<p>This open source software was developed for use with Etaluma microscopes.</p>

<p>AUTHORS:
Kevin Peter Hickerson, The Earthineering Company
Anna Iwaniec Hickerson, Keck Graduate Institute</p>

<p>MODIFIED:
January 22, 2023</p>
</div>

                        <input id="mod-trinamic850-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-trinamic850-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">MIT License</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">Copyright (c) 2020 Etaluma, Inc.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">in the Software without restriction, including without limitation the rights</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">copies of the Software, and to permit persons to whom the Software is</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">furnished to do so, subject to the following conditions:</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">The above copyribackground_downght notice and this permission notice shall be included in all</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">copies or substantial portions of the Software.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">SOFTWARE.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">```</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">```</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">This open source software was developed for use with Etaluma microscopes.</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">AUTHORS:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">Kevin Peter Hickerson, The Earthineering Company</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">Anna Iwaniec Hickerson, Keck Graduate Institute</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">MODIFIED:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">January 22, 2023</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="kn">import</span> <span class="nn">threading</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="kn">import</span> <span class="nn">queue</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="kn">import</span> <span class="nn">serial</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="kn">import</span> <span class="nn">serial.tools.list_ports</span> <span class="k">as</span> <span class="nn">list_ports</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="k">class</span> <span class="nc">TrinamicBoard</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="c1"># Initialize connection through microcontroller</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="n">ports</span> <span class="o">=</span> <span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">(</span><span class="n">include_links</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.__init__()&#39;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backlash</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># um of additional downlaod travel in z for drive hysterisis</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">vid</span> <span class="o">==</span> <span class="mh">0x2E8A</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mh">0x0005</span><span class="p">):</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Motor Controller at&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>                <span class="k">break</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">115200</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bytesize</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">EIGHTBITS</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">PARITY_NONE</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopbits</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">STOPBITS_ONE</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># seconds</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write_timeout</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># seconds</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="c1"># def __del__(self):</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="c1">#     if self.driver != False:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="c1">#         self.driver.close()</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Try to connect to the motor controller based on the known VID/PID&quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>                                        <span class="n">baudrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baudrate</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>                                        <span class="n">bytesize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bytesize</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>                                        <span class="n">parity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>                                        <span class="n">stopbits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stopbits</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>                                        <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>                                        <span class="n">write_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">write_timeout</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>            
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.connect()</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">response</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TrinamicBoard.connect()</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.connect() failed&#39;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TrinamicBoard.connect() succeeded&#39;</span><span class="p">)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="c1"># Define Communication</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="nf">exchange_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Exchange command through serial to SPI to the Trinamic boards</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        This should NOT be used in a script. It is intended for other functions to access&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.exchange_command(&#39;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>                <span class="k">return</span> <span class="n">response</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>                
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>            <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialTimeoutException</span><span class="p">:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.exchange_command(&#39;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39;) Serial Timeout Occurred&#39;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="c1"># Firmware 1-14-2023 commands include</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="c1"># &#39;QUIT&#39;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="c1"># &#39;INFO&#39;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="c1"># &#39;HOME&#39;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="c1"># &#39;ZHOME&#39;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="c1"># &#39;THOME&#39;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="c1"># &#39;ACTUAL_R&#39;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="c1"># &#39;ACTUAL_W&#39;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="c1"># &#39;TARGET_R&#39;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="c1"># &#39;TARGET_W&#39;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="c1"># &#39;STATUS_R&#39;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="c1"># &#39;SPI&#39;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="c1"># def SPI_put (self, pin: int, address: int, data: int):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="c1">#     if self.buffer == False:</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="c1">#         self.buffer = queue.Queue(1024)  # could add buffer size to settings someday</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="c1">#     if self.buffer.full():</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="c1">#        print(&quot;Trinamic SPI write buffer size is &quot;+self.buffer.qsize()+&quot; and is full.&quot;)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>    <span class="c1">#        return</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="c1">#     self.buffer.put({</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>    <span class="c1">#             pin:     pin,</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="c1">#             address: address,</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="c1">#             data:    data</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="c1">#         })</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="c1"># def SPI_get (self):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="c1">#     if self.buffer == False:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>    <span class="c1">#         return</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="c1">#     cmd = self.buffer.get()</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="c1">#     self.SPI_write(cmd.pin, cmd.address, cmd.data)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    <span class="c1"># Z (Focus) Functions</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">z_ustep2um</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.z_ustep2um(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">0.00586</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># 0.00586 um/ustep Olympus Z</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="n">um</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="k">def</span> <span class="nf">z_um2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.z_um2ustep(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">0.00586</span> <span class="p">)</span> <span class="c1"># 0.00586 um/ustep Olympus Z</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">zhome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the objective &quot;&quot;&quot;</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.zhome()&#39;</span>            
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;ZHOME&#39;</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="c1"># XY Stage Functions</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">xy_ustep2um</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xy_ustep2um(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">0.0496</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># 0.0496 um/ustep</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="n">um</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="k">def</span> <span class="nf">xy_um2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xy_um2ustep(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">0.0496</span><span class="p">)</span> <span class="c1"># 0.0496 um/ustep</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="k">def</span> <span class="nf">xyhome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the stage which also homes the objective first &quot;&quot;&quot;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xyhome()&#39;</span>            
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;HOME&#39;</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>    <span class="c1"># T (Turret) Functions</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">t_ustep2deg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.t_ustep2deg(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># needs correct value</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="n">um</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">t_deg2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.t_ustep2deg(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">1.</span><span class="p">)</span> <span class="c1"># needs correct value</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">thome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the turret, not yet functional in hardware&quot;&quot;&quot;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.thome()&#39;</span>            
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;THOME&#39;</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">tmove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move the turret, not yet functional in hardware&quot;&quot;&quot;</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.thome()&#39;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_deg2ustep</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="c1"># Motion Functions</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a> 
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move the axis to an absolute position (in usteps)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        compared to Home &quot;&quot;&quot;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>            <span class="n">steps</span> <span class="o">+=</span> <span class="mh">0x100000000</span> <span class="c1"># twos compliment</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;TARGET_W&#39;</span> <span class="o">+</span> <span class="n">axis</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps</span><span class="p">))</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="c1"># Get target position</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="k">def</span> <span class="nf">target_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the target position of an axis&quot;&quot;&quot;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;TARGET_R&#39;</span> <span class="o">+</span> <span class="n">axis</span> <span class="p">)</span> <span class="p">)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>            
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="k">return</span> <span class="n">um</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="c1"># Get current position (in um)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">current_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current position (in um) of axis&quot;&quot;&quot;</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;ACTUAL_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.current_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>            
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>            <span class="k">return</span> <span class="n">um</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.current_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="c1"># Move to absolute position (in um)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>    <span class="k">def</span> <span class="nf">move_abs_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move to absolute position (in um) of axis&quot;&quot;&quot;</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="c1"># Z bound between 0 to 14mm</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">14000</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">14000.</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="c1"># X bound 0 to 120mm</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">120000</span><span class="p">:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">120000.</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="c1"># y bound 0 to 80mm</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">80000</span><span class="p">:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">80000.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="c1"># perform overshoot to always come from one direction</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>                <span class="c1"># get current position</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>                <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                <span class="c1"># if the current position is above the new target position</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>                <span class="k">if</span> <span class="n">current</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>                    <span class="c1"># In process of overshoot</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>                    <span class="c1"># First overshoot downwards</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>                    <span class="n">overshoot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">backlash</span><span class="p">)</span> <span class="c1"># target minus backlash</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                    <span class="n">overshoot</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">overshoot</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>                    <span class="c1">#self.SPI_write (self.chip_pin[axis], self.write_target[axis], overshoot)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">overshoot</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>                    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_status</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                    <span class="c1"># complete overshoot</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_abs_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_abs_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>    <span class="c1"># Move by relative distance (in um)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">move_rel_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move by relative distance (in um) of axis &quot;&quot;&quot;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>            <span class="c1"># Read target position in um</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_pos</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move_abs_pos</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">pos</span><span class="o">+</span><span class="n">um</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_rel_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_rel_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>    <span class="c1"># Ramp and Reference Switch Status Register</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>    <span class="c1"># return True if current and target position are at home.</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>    <span class="k">def</span> <span class="nf">home_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Return True if axis is in home position&quot;&quot;&quot;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.home_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.home_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>    <span class="c1"># return True if current position and target position are the same</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>    <span class="k">def</span> <span class="nf">target_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Return True if axis is at target position&quot;&quot;&quot;</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>  
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>  
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.get_limit_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>    <span class="c1"># Get all reference status register bits as 32 character string (32-&gt; 0)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>    <span class="k">def</span> <span class="nf">reference_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Get all reference status register bits as 32 character string (32-&gt; 0) &quot;&quot;&quot;</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="c1"># data is an integer that represents 4 bytes, or 32 bits,</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>            <span class="c1"># largest bit first</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">            bit: 33222222222211111111110000000000</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">            bit: 10987654321098765432109876543210</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">            bit: ----------------------*-------**</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.reference_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd"># signed 32 bit hex to dec</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">if value &gt;=  0x80000000:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">    value -= 0x10000000</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">print(int(value))</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd"># signed dec to 32 bit hex</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">value = -200000</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">if value &lt; 0:</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">    value = 4294967296+value</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">print(hex(value))</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">&#39;&#39;&#39;</span>
</span></pre></div>


            </section>
                <section id="TrinamicBoard">
                            <input id="TrinamicBoard-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TrinamicBoard</span>:

                <label class="view-source-button" for="TrinamicBoard-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard-45"><a href="#TrinamicBoard-45"><span class="linenos"> 45</span></a><span class="k">class</span> <span class="nc">TrinamicBoard</span><span class="p">:</span>
</span><span id="TrinamicBoard-46"><a href="#TrinamicBoard-46"><span class="linenos"> 46</span></a>
</span><span id="TrinamicBoard-47"><a href="#TrinamicBoard-47"><span class="linenos"> 47</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-48"><a href="#TrinamicBoard-48"><span class="linenos"> 48</span></a>    <span class="c1"># Initialize connection through microcontroller</span>
</span><span id="TrinamicBoard-49"><a href="#TrinamicBoard-49"><span class="linenos"> 49</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-50"><a href="#TrinamicBoard-50"><span class="linenos"> 50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TrinamicBoard-51"><a href="#TrinamicBoard-51"><span class="linenos"> 51</span></a>        <span class="n">ports</span> <span class="o">=</span> <span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">(</span><span class="n">include_links</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="TrinamicBoard-52"><a href="#TrinamicBoard-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.__init__()&#39;</span>
</span><span id="TrinamicBoard-53"><a href="#TrinamicBoard-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-54"><a href="#TrinamicBoard-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-55"><a href="#TrinamicBoard-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backlash</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># um of additional downlaod travel in z for drive hysterisis</span>
</span><span id="TrinamicBoard-56"><a href="#TrinamicBoard-56"><span class="linenos"> 56</span></a>
</span><span id="TrinamicBoard-57"><a href="#TrinamicBoard-57"><span class="linenos"> 57</span></a>        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
</span><span id="TrinamicBoard-58"><a href="#TrinamicBoard-58"><span class="linenos"> 58</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">vid</span> <span class="o">==</span> <span class="mh">0x2E8A</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mh">0x0005</span><span class="p">):</span>
</span><span id="TrinamicBoard-59"><a href="#TrinamicBoard-59"><span class="linenos"> 59</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Motor Controller at&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="TrinamicBoard-60"><a href="#TrinamicBoard-60"><span class="linenos"> 60</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span>
</span><span id="TrinamicBoard-61"><a href="#TrinamicBoard-61"><span class="linenos"> 61</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TrinamicBoard-62"><a href="#TrinamicBoard-62"><span class="linenos"> 62</span></a>                <span class="k">break</span>
</span><span id="TrinamicBoard-63"><a href="#TrinamicBoard-63"><span class="linenos"> 63</span></a>
</span><span id="TrinamicBoard-64"><a href="#TrinamicBoard-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">115200</span>
</span><span id="TrinamicBoard-65"><a href="#TrinamicBoard-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bytesize</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">EIGHTBITS</span>
</span><span id="TrinamicBoard-66"><a href="#TrinamicBoard-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">PARITY_NONE</span>
</span><span id="TrinamicBoard-67"><a href="#TrinamicBoard-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopbits</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">STOPBITS_ONE</span>
</span><span id="TrinamicBoard-68"><a href="#TrinamicBoard-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># seconds</span>
</span><span id="TrinamicBoard-69"><a href="#TrinamicBoard-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write_timeout</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># seconds</span>
</span><span id="TrinamicBoard-70"><a href="#TrinamicBoard-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-71"><a href="#TrinamicBoard-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="TrinamicBoard-72"><a href="#TrinamicBoard-72"><span class="linenos"> 72</span></a>
</span><span id="TrinamicBoard-73"><a href="#TrinamicBoard-73"><span class="linenos"> 73</span></a>    <span class="c1"># def __del__(self):</span>
</span><span id="TrinamicBoard-74"><a href="#TrinamicBoard-74"><span class="linenos"> 74</span></a>    <span class="c1">#     if self.driver != False:</span>
</span><span id="TrinamicBoard-75"><a href="#TrinamicBoard-75"><span class="linenos"> 75</span></a>    <span class="c1">#         self.driver.close()</span>
</span><span id="TrinamicBoard-76"><a href="#TrinamicBoard-76"><span class="linenos"> 76</span></a>
</span><span id="TrinamicBoard-77"><a href="#TrinamicBoard-77"><span class="linenos"> 77</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard-78"><a href="#TrinamicBoard-78"><span class="linenos"> 78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Try to connect to the motor controller based on the known VID/PID&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-79"><a href="#TrinamicBoard-79"><span class="linenos"> 79</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TrinamicBoard-80"><a href="#TrinamicBoard-80"><span class="linenos"> 80</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
</span><span id="TrinamicBoard-81"><a href="#TrinamicBoard-81"><span class="linenos"> 81</span></a>                                        <span class="n">baudrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baudrate</span><span class="p">,</span>
</span><span id="TrinamicBoard-82"><a href="#TrinamicBoard-82"><span class="linenos"> 82</span></a>                                        <span class="n">bytesize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bytesize</span><span class="p">,</span>
</span><span id="TrinamicBoard-83"><a href="#TrinamicBoard-83"><span class="linenos"> 83</span></a>                                        <span class="n">parity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="p">,</span>
</span><span id="TrinamicBoard-84"><a href="#TrinamicBoard-84"><span class="linenos"> 84</span></a>                                        <span class="n">stopbits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stopbits</span><span class="p">,</span>
</span><span id="TrinamicBoard-85"><a href="#TrinamicBoard-85"><span class="linenos"> 85</span></a>                                        <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="TrinamicBoard-86"><a href="#TrinamicBoard-86"><span class="linenos"> 86</span></a>                                        <span class="n">write_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">write_timeout</span><span class="p">)</span>
</span><span id="TrinamicBoard-87"><a href="#TrinamicBoard-87"><span class="linenos"> 87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TrinamicBoard-88"><a href="#TrinamicBoard-88"><span class="linenos"> 88</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="TrinamicBoard-89"><a href="#TrinamicBoard-89"><span class="linenos"> 89</span></a>            
</span><span id="TrinamicBoard-90"><a href="#TrinamicBoard-90"><span class="linenos"> 90</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard-91"><a href="#TrinamicBoard-91"><span class="linenos"> 91</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.connect()</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">response</span>
</span><span id="TrinamicBoard-92"><a href="#TrinamicBoard-92"><span class="linenos"> 92</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TrinamicBoard.connect()</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
</span><span id="TrinamicBoard-93"><a href="#TrinamicBoard-93"><span class="linenos"> 93</span></a>
</span><span id="TrinamicBoard-94"><a href="#TrinamicBoard-94"><span class="linenos"> 94</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="TrinamicBoard-95"><a href="#TrinamicBoard-95"><span class="linenos"> 95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-96"><a href="#TrinamicBoard-96"><span class="linenos"> 96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.connect() failed&#39;</span>
</span><span id="TrinamicBoard-97"><a href="#TrinamicBoard-97"><span class="linenos"> 97</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TrinamicBoard.connect() succeeded&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard-98"><a href="#TrinamicBoard-98"><span class="linenos"> 98</span></a>
</span><span id="TrinamicBoard-99"><a href="#TrinamicBoard-99"><span class="linenos"> 99</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-100"><a href="#TrinamicBoard-100"><span class="linenos">100</span></a>    <span class="c1"># Define Communication</span>
</span><span id="TrinamicBoard-101"><a href="#TrinamicBoard-101"><span class="linenos">101</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-102"><a href="#TrinamicBoard-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">exchange_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
</span><span id="TrinamicBoard-103"><a href="#TrinamicBoard-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Exchange command through serial to SPI to the Trinamic boards</span>
</span><span id="TrinamicBoard-104"><a href="#TrinamicBoard-104"><span class="linenos">104</span></a><span class="sd">        This should NOT be used in a script. It is intended for other functions to access&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-105"><a href="#TrinamicBoard-105"><span class="linenos">105</span></a>
</span><span id="TrinamicBoard-106"><a href="#TrinamicBoard-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="TrinamicBoard-107"><a href="#TrinamicBoard-107"><span class="linenos">107</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TrinamicBoard-108"><a href="#TrinamicBoard-108"><span class="linenos">108</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TrinamicBoard-109"><a href="#TrinamicBoard-109"><span class="linenos">109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="TrinamicBoard-110"><a href="#TrinamicBoard-110"><span class="linenos">110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrinamicBoard-111"><a href="#TrinamicBoard-111"><span class="linenos">111</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span><span id="TrinamicBoard-112"><a href="#TrinamicBoard-112"><span class="linenos">112</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="TrinamicBoard-113"><a href="#TrinamicBoard-113"><span class="linenos">113</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.exchange_command(&#39;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="TrinamicBoard-114"><a href="#TrinamicBoard-114"><span class="linenos">114</span></a>                <span class="k">return</span> <span class="n">response</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>                
</span><span id="TrinamicBoard-115"><a href="#TrinamicBoard-115"><span class="linenos">115</span></a>
</span><span id="TrinamicBoard-116"><a href="#TrinamicBoard-116"><span class="linenos">116</span></a>            <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialTimeoutException</span><span class="p">:</span>
</span><span id="TrinamicBoard-117"><a href="#TrinamicBoard-117"><span class="linenos">117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.exchange_command(&#39;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39;) Serial Timeout Occurred&#39;</span>
</span><span id="TrinamicBoard-118"><a href="#TrinamicBoard-118"><span class="linenos">118</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-119"><a href="#TrinamicBoard-119"><span class="linenos">119</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-120"><a href="#TrinamicBoard-120"><span class="linenos">120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="TrinamicBoard-121"><a href="#TrinamicBoard-121"><span class="linenos">121</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-122"><a href="#TrinamicBoard-122"><span class="linenos">122</span></a>
</span><span id="TrinamicBoard-123"><a href="#TrinamicBoard-123"><span class="linenos">123</span></a>    <span class="c1"># Firmware 1-14-2023 commands include</span>
</span><span id="TrinamicBoard-124"><a href="#TrinamicBoard-124"><span class="linenos">124</span></a>    <span class="c1"># &#39;QUIT&#39;</span>
</span><span id="TrinamicBoard-125"><a href="#TrinamicBoard-125"><span class="linenos">125</span></a>    <span class="c1"># &#39;INFO&#39;</span>
</span><span id="TrinamicBoard-126"><a href="#TrinamicBoard-126"><span class="linenos">126</span></a>    <span class="c1"># &#39;HOME&#39;</span>
</span><span id="TrinamicBoard-127"><a href="#TrinamicBoard-127"><span class="linenos">127</span></a>    <span class="c1"># &#39;ZHOME&#39;</span>
</span><span id="TrinamicBoard-128"><a href="#TrinamicBoard-128"><span class="linenos">128</span></a>    <span class="c1"># &#39;THOME&#39;</span>
</span><span id="TrinamicBoard-129"><a href="#TrinamicBoard-129"><span class="linenos">129</span></a>    <span class="c1"># &#39;ACTUAL_R&#39;</span>
</span><span id="TrinamicBoard-130"><a href="#TrinamicBoard-130"><span class="linenos">130</span></a>    <span class="c1"># &#39;ACTUAL_W&#39;</span>
</span><span id="TrinamicBoard-131"><a href="#TrinamicBoard-131"><span class="linenos">131</span></a>    <span class="c1"># &#39;TARGET_R&#39;</span>
</span><span id="TrinamicBoard-132"><a href="#TrinamicBoard-132"><span class="linenos">132</span></a>    <span class="c1"># &#39;TARGET_W&#39;</span>
</span><span id="TrinamicBoard-133"><a href="#TrinamicBoard-133"><span class="linenos">133</span></a>    <span class="c1"># &#39;STATUS_R&#39;</span>
</span><span id="TrinamicBoard-134"><a href="#TrinamicBoard-134"><span class="linenos">134</span></a>    <span class="c1"># &#39;SPI&#39;</span>
</span><span id="TrinamicBoard-135"><a href="#TrinamicBoard-135"><span class="linenos">135</span></a>
</span><span id="TrinamicBoard-136"><a href="#TrinamicBoard-136"><span class="linenos">136</span></a>    
</span><span id="TrinamicBoard-137"><a href="#TrinamicBoard-137"><span class="linenos">137</span></a>    <span class="c1"># def SPI_put (self, pin: int, address: int, data: int):</span>
</span><span id="TrinamicBoard-138"><a href="#TrinamicBoard-138"><span class="linenos">138</span></a>    <span class="c1">#     if self.buffer == False:</span>
</span><span id="TrinamicBoard-139"><a href="#TrinamicBoard-139"><span class="linenos">139</span></a>    <span class="c1">#         self.buffer = queue.Queue(1024)  # could add buffer size to settings someday</span>
</span><span id="TrinamicBoard-140"><a href="#TrinamicBoard-140"><span class="linenos">140</span></a>        
</span><span id="TrinamicBoard-141"><a href="#TrinamicBoard-141"><span class="linenos">141</span></a>    <span class="c1">#     if self.buffer.full():</span>
</span><span id="TrinamicBoard-142"><a href="#TrinamicBoard-142"><span class="linenos">142</span></a>    <span class="c1">#        print(&quot;Trinamic SPI write buffer size is &quot;+self.buffer.qsize()+&quot; and is full.&quot;)</span>
</span><span id="TrinamicBoard-143"><a href="#TrinamicBoard-143"><span class="linenos">143</span></a>    <span class="c1">#        return</span>
</span><span id="TrinamicBoard-144"><a href="#TrinamicBoard-144"><span class="linenos">144</span></a>        
</span><span id="TrinamicBoard-145"><a href="#TrinamicBoard-145"><span class="linenos">145</span></a>    <span class="c1">#     self.buffer.put({</span>
</span><span id="TrinamicBoard-146"><a href="#TrinamicBoard-146"><span class="linenos">146</span></a>    <span class="c1">#             pin:     pin,</span>
</span><span id="TrinamicBoard-147"><a href="#TrinamicBoard-147"><span class="linenos">147</span></a>    <span class="c1">#             address: address,</span>
</span><span id="TrinamicBoard-148"><a href="#TrinamicBoard-148"><span class="linenos">148</span></a>    <span class="c1">#             data:    data</span>
</span><span id="TrinamicBoard-149"><a href="#TrinamicBoard-149"><span class="linenos">149</span></a>    <span class="c1">#         })</span>
</span><span id="TrinamicBoard-150"><a href="#TrinamicBoard-150"><span class="linenos">150</span></a>
</span><span id="TrinamicBoard-151"><a href="#TrinamicBoard-151"><span class="linenos">151</span></a>    <span class="c1"># def SPI_get (self):</span>
</span><span id="TrinamicBoard-152"><a href="#TrinamicBoard-152"><span class="linenos">152</span></a>    <span class="c1">#     if self.buffer == False:</span>
</span><span id="TrinamicBoard-153"><a href="#TrinamicBoard-153"><span class="linenos">153</span></a>    <span class="c1">#         return</span>
</span><span id="TrinamicBoard-154"><a href="#TrinamicBoard-154"><span class="linenos">154</span></a>        
</span><span id="TrinamicBoard-155"><a href="#TrinamicBoard-155"><span class="linenos">155</span></a>    <span class="c1">#     cmd = self.buffer.get()</span>
</span><span id="TrinamicBoard-156"><a href="#TrinamicBoard-156"><span class="linenos">156</span></a>    <span class="c1">#     self.SPI_write(cmd.pin, cmd.address, cmd.data)</span>
</span><span id="TrinamicBoard-157"><a href="#TrinamicBoard-157"><span class="linenos">157</span></a>
</span><span id="TrinamicBoard-158"><a href="#TrinamicBoard-158"><span class="linenos">158</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-159"><a href="#TrinamicBoard-159"><span class="linenos">159</span></a>    <span class="c1"># Z (Focus) Functions</span>
</span><span id="TrinamicBoard-160"><a href="#TrinamicBoard-160"><span class="linenos">160</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-161"><a href="#TrinamicBoard-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">z_ustep2um</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="TrinamicBoard-162"><a href="#TrinamicBoard-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.z_ustep2um(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-163"><a href="#TrinamicBoard-163"><span class="linenos">163</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">0.00586</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># 0.00586 um/ustep Olympus Z</span>
</span><span id="TrinamicBoard-164"><a href="#TrinamicBoard-164"><span class="linenos">164</span></a>        <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard-165"><a href="#TrinamicBoard-165"><span class="linenos">165</span></a>
</span><span id="TrinamicBoard-166"><a href="#TrinamicBoard-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">z_um2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard-167"><a href="#TrinamicBoard-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.z_um2ustep(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-168"><a href="#TrinamicBoard-168"><span class="linenos">168</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">0.00586</span> <span class="p">)</span> <span class="c1"># 0.00586 um/ustep Olympus Z</span>
</span><span id="TrinamicBoard-169"><a href="#TrinamicBoard-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span><span id="TrinamicBoard-170"><a href="#TrinamicBoard-170"><span class="linenos">170</span></a>
</span><span id="TrinamicBoard-171"><a href="#TrinamicBoard-171"><span class="linenos">171</span></a>    <span class="k">def</span> <span class="nf">zhome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard-172"><a href="#TrinamicBoard-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the objective &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-173"><a href="#TrinamicBoard-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.zhome()&#39;</span>            
</span><span id="TrinamicBoard-174"><a href="#TrinamicBoard-174"><span class="linenos">174</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-175"><a href="#TrinamicBoard-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;ZHOME&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard-176"><a href="#TrinamicBoard-176"><span class="linenos">176</span></a>
</span><span id="TrinamicBoard-177"><a href="#TrinamicBoard-177"><span class="linenos">177</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-178"><a href="#TrinamicBoard-178"><span class="linenos">178</span></a>    <span class="c1"># XY Stage Functions</span>
</span><span id="TrinamicBoard-179"><a href="#TrinamicBoard-179"><span class="linenos">179</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-180"><a href="#TrinamicBoard-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">xy_ustep2um</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="TrinamicBoard-181"><a href="#TrinamicBoard-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xy_ustep2um(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-182"><a href="#TrinamicBoard-182"><span class="linenos">182</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">0.0496</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># 0.0496 um/ustep</span>
</span><span id="TrinamicBoard-183"><a href="#TrinamicBoard-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard-184"><a href="#TrinamicBoard-184"><span class="linenos">184</span></a>
</span><span id="TrinamicBoard-185"><a href="#TrinamicBoard-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">xy_um2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard-186"><a href="#TrinamicBoard-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xy_um2ustep(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-187"><a href="#TrinamicBoard-187"><span class="linenos">187</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">0.0496</span><span class="p">)</span> <span class="c1"># 0.0496 um/ustep</span>
</span><span id="TrinamicBoard-188"><a href="#TrinamicBoard-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span><span id="TrinamicBoard-189"><a href="#TrinamicBoard-189"><span class="linenos">189</span></a>
</span><span id="TrinamicBoard-190"><a href="#TrinamicBoard-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">xyhome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard-191"><a href="#TrinamicBoard-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the stage which also homes the objective first &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-192"><a href="#TrinamicBoard-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xyhome()&#39;</span>            
</span><span id="TrinamicBoard-193"><a href="#TrinamicBoard-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-194"><a href="#TrinamicBoard-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;HOME&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard-195"><a href="#TrinamicBoard-195"><span class="linenos">195</span></a>
</span><span id="TrinamicBoard-196"><a href="#TrinamicBoard-196"><span class="linenos">196</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-197"><a href="#TrinamicBoard-197"><span class="linenos">197</span></a>    <span class="c1"># T (Turret) Functions</span>
</span><span id="TrinamicBoard-198"><a href="#TrinamicBoard-198"><span class="linenos">198</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-199"><a href="#TrinamicBoard-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">t_ustep2deg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="TrinamicBoard-200"><a href="#TrinamicBoard-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.t_ustep2deg(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-201"><a href="#TrinamicBoard-201"><span class="linenos">201</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># needs correct value</span>
</span><span id="TrinamicBoard-202"><a href="#TrinamicBoard-202"><span class="linenos">202</span></a>        <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard-203"><a href="#TrinamicBoard-203"><span class="linenos">203</span></a>
</span><span id="TrinamicBoard-204"><a href="#TrinamicBoard-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">t_deg2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard-205"><a href="#TrinamicBoard-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.t_ustep2deg(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-206"><a href="#TrinamicBoard-206"><span class="linenos">206</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">1.</span><span class="p">)</span> <span class="c1"># needs correct value</span>
</span><span id="TrinamicBoard-207"><a href="#TrinamicBoard-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span><span id="TrinamicBoard-208"><a href="#TrinamicBoard-208"><span class="linenos">208</span></a>
</span><span id="TrinamicBoard-209"><a href="#TrinamicBoard-209"><span class="linenos">209</span></a>    <span class="k">def</span> <span class="nf">thome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard-210"><a href="#TrinamicBoard-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the turret, not yet functional in hardware&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-211"><a href="#TrinamicBoard-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.thome()&#39;</span>            
</span><span id="TrinamicBoard-212"><a href="#TrinamicBoard-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-213"><a href="#TrinamicBoard-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;THOME&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard-214"><a href="#TrinamicBoard-214"><span class="linenos">214</span></a>
</span><span id="TrinamicBoard-215"><a href="#TrinamicBoard-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">tmove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">):</span>
</span><span id="TrinamicBoard-216"><a href="#TrinamicBoard-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move the turret, not yet functional in hardware&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-217"><a href="#TrinamicBoard-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.thome()&#39;</span>
</span><span id="TrinamicBoard-218"><a href="#TrinamicBoard-218"><span class="linenos">218</span></a>        <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_deg2ustep</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
</span><span id="TrinamicBoard-219"><a href="#TrinamicBoard-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-220"><a href="#TrinamicBoard-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="TrinamicBoard-221"><a href="#TrinamicBoard-221"><span class="linenos">221</span></a>
</span><span id="TrinamicBoard-222"><a href="#TrinamicBoard-222"><span class="linenos">222</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-223"><a href="#TrinamicBoard-223"><span class="linenos">223</span></a>    <span class="c1"># Motion Functions</span>
</span><span id="TrinamicBoard-224"><a href="#TrinamicBoard-224"><span class="linenos">224</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-225"><a href="#TrinamicBoard-225"><span class="linenos">225</span></a> 
</span><span id="TrinamicBoard-226"><a href="#TrinamicBoard-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
</span><span id="TrinamicBoard-227"><a href="#TrinamicBoard-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move the axis to an absolute position (in usteps)</span>
</span><span id="TrinamicBoard-228"><a href="#TrinamicBoard-228"><span class="linenos">228</span></a><span class="sd">        compared to Home &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-229"><a href="#TrinamicBoard-229"><span class="linenos">229</span></a>
</span><span id="TrinamicBoard-230"><a href="#TrinamicBoard-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard-231"><a href="#TrinamicBoard-231"><span class="linenos">231</span></a>            <span class="n">steps</span> <span class="o">+=</span> <span class="mh">0x100000000</span> <span class="c1"># twos compliment</span>
</span><span id="TrinamicBoard-232"><a href="#TrinamicBoard-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;TARGET_W&#39;</span> <span class="o">+</span> <span class="n">axis</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps</span><span class="p">))</span>
</span><span id="TrinamicBoard-233"><a href="#TrinamicBoard-233"><span class="linenos">233</span></a>
</span><span id="TrinamicBoard-234"><a href="#TrinamicBoard-234"><span class="linenos">234</span></a>    <span class="c1"># Get target position</span>
</span><span id="TrinamicBoard-235"><a href="#TrinamicBoard-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">target_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard-236"><a href="#TrinamicBoard-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the target position of an axis&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-237"><a href="#TrinamicBoard-237"><span class="linenos">237</span></a>
</span><span id="TrinamicBoard-238"><a href="#TrinamicBoard-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-239"><a href="#TrinamicBoard-239"><span class="linenos">239</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;TARGET_R&#39;</span> <span class="o">+</span> <span class="n">axis</span> <span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard-240"><a href="#TrinamicBoard-240"><span class="linenos">240</span></a>
</span><span id="TrinamicBoard-241"><a href="#TrinamicBoard-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard-242"><a href="#TrinamicBoard-242"><span class="linenos">242</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-243"><a href="#TrinamicBoard-243"><span class="linenos">243</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-244"><a href="#TrinamicBoard-244"><span class="linenos">244</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-245"><a href="#TrinamicBoard-245"><span class="linenos">245</span></a>
</span><span id="TrinamicBoard-246"><a href="#TrinamicBoard-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>            
</span><span id="TrinamicBoard-247"><a href="#TrinamicBoard-247"><span class="linenos">247</span></a>            <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard-248"><a href="#TrinamicBoard-248"><span class="linenos">248</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-249"><a href="#TrinamicBoard-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard-250"><a href="#TrinamicBoard-250"><span class="linenos">250</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="TrinamicBoard-251"><a href="#TrinamicBoard-251"><span class="linenos">251</span></a>
</span><span id="TrinamicBoard-252"><a href="#TrinamicBoard-252"><span class="linenos">252</span></a>    <span class="c1"># Get current position (in um)</span>
</span><span id="TrinamicBoard-253"><a href="#TrinamicBoard-253"><span class="linenos">253</span></a>    <span class="k">def</span> <span class="nf">current_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard-254"><a href="#TrinamicBoard-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current position (in um) of axis&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-255"><a href="#TrinamicBoard-255"><span class="linenos">255</span></a>        
</span><span id="TrinamicBoard-256"><a href="#TrinamicBoard-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-257"><a href="#TrinamicBoard-257"><span class="linenos">257</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;ACTUAL_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard-258"><a href="#TrinamicBoard-258"><span class="linenos">258</span></a>
</span><span id="TrinamicBoard-259"><a href="#TrinamicBoard-259"><span class="linenos">259</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard-260"><a href="#TrinamicBoard-260"><span class="linenos">260</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-261"><a href="#TrinamicBoard-261"><span class="linenos">261</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-262"><a href="#TrinamicBoard-262"><span class="linenos">262</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-263"><a href="#TrinamicBoard-263"><span class="linenos">263</span></a>
</span><span id="TrinamicBoard-264"><a href="#TrinamicBoard-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.current_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>            
</span><span id="TrinamicBoard-265"><a href="#TrinamicBoard-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard-266"><a href="#TrinamicBoard-266"><span class="linenos">266</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-267"><a href="#TrinamicBoard-267"><span class="linenos">267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.current_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard-268"><a href="#TrinamicBoard-268"><span class="linenos">268</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="TrinamicBoard-269"><a href="#TrinamicBoard-269"><span class="linenos">269</span></a>
</span><span id="TrinamicBoard-270"><a href="#TrinamicBoard-270"><span class="linenos">270</span></a>    <span class="c1"># Move to absolute position (in um)</span>
</span><span id="TrinamicBoard-271"><a href="#TrinamicBoard-271"><span class="linenos">271</span></a>    <span class="k">def</span> <span class="nf">move_abs_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
</span><span id="TrinamicBoard-272"><a href="#TrinamicBoard-272"><span class="linenos">272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move to absolute position (in um) of axis&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-273"><a href="#TrinamicBoard-273"><span class="linenos">273</span></a>
</span><span id="TrinamicBoard-274"><a href="#TrinamicBoard-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-275"><a href="#TrinamicBoard-275"><span class="linenos">275</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="c1"># Z bound between 0 to 14mm</span>
</span><span id="TrinamicBoard-276"><a href="#TrinamicBoard-276"><span class="linenos">276</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard-277"><a href="#TrinamicBoard-277"><span class="linenos">277</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="TrinamicBoard-278"><a href="#TrinamicBoard-278"><span class="linenos">278</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">14000</span><span class="p">:</span>
</span><span id="TrinamicBoard-279"><a href="#TrinamicBoard-279"><span class="linenos">279</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">14000.</span>
</span><span id="TrinamicBoard-280"><a href="#TrinamicBoard-280"><span class="linenos">280</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-281"><a href="#TrinamicBoard-281"><span class="linenos">281</span></a>            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="c1"># X bound 0 to 120mm</span>
</span><span id="TrinamicBoard-282"><a href="#TrinamicBoard-282"><span class="linenos">282</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard-283"><a href="#TrinamicBoard-283"><span class="linenos">283</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="TrinamicBoard-284"><a href="#TrinamicBoard-284"><span class="linenos">284</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">120000</span><span class="p">:</span>
</span><span id="TrinamicBoard-285"><a href="#TrinamicBoard-285"><span class="linenos">285</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">120000.</span>
</span><span id="TrinamicBoard-286"><a href="#TrinamicBoard-286"><span class="linenos">286</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-287"><a href="#TrinamicBoard-287"><span class="linenos">287</span></a>            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="c1"># y bound 0 to 80mm</span>
</span><span id="TrinamicBoard-288"><a href="#TrinamicBoard-288"><span class="linenos">288</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard-289"><a href="#TrinamicBoard-289"><span class="linenos">289</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="TrinamicBoard-290"><a href="#TrinamicBoard-290"><span class="linenos">290</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">80000</span><span class="p">:</span>
</span><span id="TrinamicBoard-291"><a href="#TrinamicBoard-291"><span class="linenos">291</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">80000.</span>
</span><span id="TrinamicBoard-292"><a href="#TrinamicBoard-292"><span class="linenos">292</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard-293"><a href="#TrinamicBoard-293"><span class="linenos">293</span></a>
</span><span id="TrinamicBoard-294"><a href="#TrinamicBoard-294"><span class="linenos">294</span></a>            <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="c1"># perform overshoot to always come from one direction</span>
</span><span id="TrinamicBoard-295"><a href="#TrinamicBoard-295"><span class="linenos">295</span></a>                <span class="c1"># get current position</span>
</span><span id="TrinamicBoard-296"><a href="#TrinamicBoard-296"><span class="linenos">296</span></a>                <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard-297"><a href="#TrinamicBoard-297"><span class="linenos">297</span></a>
</span><span id="TrinamicBoard-298"><a href="#TrinamicBoard-298"><span class="linenos">298</span></a>                <span class="c1"># if the current position is above the new target position</span>
</span><span id="TrinamicBoard-299"><a href="#TrinamicBoard-299"><span class="linenos">299</span></a>                <span class="k">if</span> <span class="n">current</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
</span><span id="TrinamicBoard-300"><a href="#TrinamicBoard-300"><span class="linenos">300</span></a>                    <span class="c1"># In process of overshoot</span>
</span><span id="TrinamicBoard-301"><a href="#TrinamicBoard-301"><span class="linenos">301</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TrinamicBoard-302"><a href="#TrinamicBoard-302"><span class="linenos">302</span></a>                    <span class="c1"># First overshoot downwards</span>
</span><span id="TrinamicBoard-303"><a href="#TrinamicBoard-303"><span class="linenos">303</span></a>                    <span class="n">overshoot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">backlash</span><span class="p">)</span> <span class="c1"># target minus backlash</span>
</span><span id="TrinamicBoard-304"><a href="#TrinamicBoard-304"><span class="linenos">304</span></a>                    <span class="n">overshoot</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">overshoot</span><span class="p">)</span>
</span><span id="TrinamicBoard-305"><a href="#TrinamicBoard-305"><span class="linenos">305</span></a>                    <span class="c1">#self.SPI_write (self.chip_pin[axis], self.write_target[axis], overshoot)</span>
</span><span id="TrinamicBoard-306"><a href="#TrinamicBoard-306"><span class="linenos">306</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">overshoot</span><span class="p">)</span>
</span><span id="TrinamicBoard-307"><a href="#TrinamicBoard-307"><span class="linenos">307</span></a>                    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_status</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
</span><span id="TrinamicBoard-308"><a href="#TrinamicBoard-308"><span class="linenos">308</span></a>                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</span><span id="TrinamicBoard-309"><a href="#TrinamicBoard-309"><span class="linenos">309</span></a>                    <span class="c1"># complete overshoot</span>
</span><span id="TrinamicBoard-310"><a href="#TrinamicBoard-310"><span class="linenos">310</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-311"><a href="#TrinamicBoard-311"><span class="linenos">311</span></a>
</span><span id="TrinamicBoard-312"><a href="#TrinamicBoard-312"><span class="linenos">312</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="TrinamicBoard-313"><a href="#TrinamicBoard-313"><span class="linenos">313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_abs_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="TrinamicBoard-314"><a href="#TrinamicBoard-314"><span class="linenos">314</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-315"><a href="#TrinamicBoard-315"><span class="linenos">315</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_abs_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>
</span><span id="TrinamicBoard-316"><a href="#TrinamicBoard-316"><span class="linenos">316</span></a>
</span><span id="TrinamicBoard-317"><a href="#TrinamicBoard-317"><span class="linenos">317</span></a>    <span class="c1"># Move by relative distance (in um)</span>
</span><span id="TrinamicBoard-318"><a href="#TrinamicBoard-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">move_rel_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard-319"><a href="#TrinamicBoard-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move by relative distance (in um) of axis &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-320"><a href="#TrinamicBoard-320"><span class="linenos">320</span></a>
</span><span id="TrinamicBoard-321"><a href="#TrinamicBoard-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-322"><a href="#TrinamicBoard-322"><span class="linenos">322</span></a>            <span class="c1"># Read target position in um</span>
</span><span id="TrinamicBoard-323"><a href="#TrinamicBoard-323"><span class="linenos">323</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_pos</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span id="TrinamicBoard-324"><a href="#TrinamicBoard-324"><span class="linenos">324</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move_abs_pos</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">pos</span><span class="o">+</span><span class="n">um</span><span class="p">)</span>
</span><span id="TrinamicBoard-325"><a href="#TrinamicBoard-325"><span class="linenos">325</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_rel_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="TrinamicBoard-326"><a href="#TrinamicBoard-326"><span class="linenos">326</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-327"><a href="#TrinamicBoard-327"><span class="linenos">327</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_rel_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>
</span><span id="TrinamicBoard-328"><a href="#TrinamicBoard-328"><span class="linenos">328</span></a>
</span><span id="TrinamicBoard-329"><a href="#TrinamicBoard-329"><span class="linenos">329</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-330"><a href="#TrinamicBoard-330"><span class="linenos">330</span></a>    <span class="c1"># Ramp and Reference Switch Status Register</span>
</span><span id="TrinamicBoard-331"><a href="#TrinamicBoard-331"><span class="linenos">331</span></a>    <span class="c1">#----------------------------------------------------------</span>
</span><span id="TrinamicBoard-332"><a href="#TrinamicBoard-332"><span class="linenos">332</span></a>
</span><span id="TrinamicBoard-333"><a href="#TrinamicBoard-333"><span class="linenos">333</span></a>    <span class="c1"># return True if current and target position are at home.</span>
</span><span id="TrinamicBoard-334"><a href="#TrinamicBoard-334"><span class="linenos">334</span></a>    <span class="k">def</span> <span class="nf">home_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard-335"><a href="#TrinamicBoard-335"><span class="linenos">335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Return True if axis is in home position&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-336"><a href="#TrinamicBoard-336"><span class="linenos">336</span></a>
</span><span id="TrinamicBoard-337"><a href="#TrinamicBoard-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.home_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard-338"><a href="#TrinamicBoard-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-339"><a href="#TrinamicBoard-339"><span class="linenos">339</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard-340"><a href="#TrinamicBoard-340"><span class="linenos">340</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="TrinamicBoard-341"><a href="#TrinamicBoard-341"><span class="linenos">341</span></a>
</span><span id="TrinamicBoard-342"><a href="#TrinamicBoard-342"><span class="linenos">342</span></a>            <span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard-343"><a href="#TrinamicBoard-343"><span class="linenos">343</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="TrinamicBoard-344"><a href="#TrinamicBoard-344"><span class="linenos">344</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-345"><a href="#TrinamicBoard-345"><span class="linenos">345</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-346"><a href="#TrinamicBoard-346"><span class="linenos">346</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-347"><a href="#TrinamicBoard-347"><span class="linenos">347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.home_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard-348"><a href="#TrinamicBoard-348"><span class="linenos">348</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-349"><a href="#TrinamicBoard-349"><span class="linenos">349</span></a>
</span><span id="TrinamicBoard-350"><a href="#TrinamicBoard-350"><span class="linenos">350</span></a>    <span class="c1"># return True if current position and target position are the same</span>
</span><span id="TrinamicBoard-351"><a href="#TrinamicBoard-351"><span class="linenos">351</span></a>    <span class="k">def</span> <span class="nf">target_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard-352"><a href="#TrinamicBoard-352"><span class="linenos">352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Return True if axis is at target position&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-353"><a href="#TrinamicBoard-353"><span class="linenos">353</span></a>
</span><span id="TrinamicBoard-354"><a href="#TrinamicBoard-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>  
</span><span id="TrinamicBoard-355"><a href="#TrinamicBoard-355"><span class="linenos">355</span></a>        
</span><span id="TrinamicBoard-356"><a href="#TrinamicBoard-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-357"><a href="#TrinamicBoard-357"><span class="linenos">357</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard-358"><a href="#TrinamicBoard-358"><span class="linenos">358</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="TrinamicBoard-359"><a href="#TrinamicBoard-359"><span class="linenos">359</span></a>
</span><span id="TrinamicBoard-360"><a href="#TrinamicBoard-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard-361"><a href="#TrinamicBoard-361"><span class="linenos">361</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="TrinamicBoard-362"><a href="#TrinamicBoard-362"><span class="linenos">362</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-363"><a href="#TrinamicBoard-363"><span class="linenos">363</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-364"><a href="#TrinamicBoard-364"><span class="linenos">364</span></a>  
</span><span id="TrinamicBoard-365"><a href="#TrinamicBoard-365"><span class="linenos">365</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-366"><a href="#TrinamicBoard-366"><span class="linenos">366</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.get_limit_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard-367"><a href="#TrinamicBoard-367"><span class="linenos">367</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard-368"><a href="#TrinamicBoard-368"><span class="linenos">368</span></a>
</span><span id="TrinamicBoard-369"><a href="#TrinamicBoard-369"><span class="linenos">369</span></a>
</span><span id="TrinamicBoard-370"><a href="#TrinamicBoard-370"><span class="linenos">370</span></a>    <span class="c1"># Get all reference status register bits as 32 character string (32-&gt; 0)</span>
</span><span id="TrinamicBoard-371"><a href="#TrinamicBoard-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">reference_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard-372"><a href="#TrinamicBoard-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Get all reference status register bits as 32 character string (32-&gt; 0) &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard-373"><a href="#TrinamicBoard-373"><span class="linenos">373</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard-374"><a href="#TrinamicBoard-374"><span class="linenos">374</span></a>
</span><span id="TrinamicBoard-375"><a href="#TrinamicBoard-375"><span class="linenos">375</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard-376"><a href="#TrinamicBoard-376"><span class="linenos">376</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="TrinamicBoard-377"><a href="#TrinamicBoard-377"><span class="linenos">377</span></a>
</span><span id="TrinamicBoard-378"><a href="#TrinamicBoard-378"><span class="linenos">378</span></a>            <span class="c1"># data is an integer that represents 4 bytes, or 32 bits,</span>
</span><span id="TrinamicBoard-379"><a href="#TrinamicBoard-379"><span class="linenos">379</span></a>            <span class="c1"># largest bit first</span>
</span><span id="TrinamicBoard-380"><a href="#TrinamicBoard-380"><span class="linenos">380</span></a><span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="TrinamicBoard-381"><a href="#TrinamicBoard-381"><span class="linenos">381</span></a><span class="sd">            bit: 33222222222211111111110000000000</span>
</span><span id="TrinamicBoard-382"><a href="#TrinamicBoard-382"><span class="linenos">382</span></a><span class="sd">            bit: 10987654321098765432109876543210</span>
</span><span id="TrinamicBoard-383"><a href="#TrinamicBoard-383"><span class="linenos">383</span></a><span class="sd">            bit: ----------------------*-------**</span>
</span><span id="TrinamicBoard-384"><a href="#TrinamicBoard-384"><span class="linenos">384</span></a><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="TrinamicBoard-385"><a href="#TrinamicBoard-385"><span class="linenos">385</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="TrinamicBoard-386"><a href="#TrinamicBoard-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="TrinamicBoard-387"><a href="#TrinamicBoard-387"><span class="linenos">387</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard-388"><a href="#TrinamicBoard-388"><span class="linenos">388</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.reference_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard-389"><a href="#TrinamicBoard-389"><span class="linenos">389</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


    

                            <div id="TrinamicBoard.__init__" class="classattr">
                                        <input id="TrinamicBoard.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TrinamicBoard</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="TrinamicBoard.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.__init__-50"><a href="#TrinamicBoard.__init__-50"><span class="linenos">50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TrinamicBoard.__init__-51"><a href="#TrinamicBoard.__init__-51"><span class="linenos">51</span></a>        <span class="n">ports</span> <span class="o">=</span> <span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">(</span><span class="n">include_links</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="TrinamicBoard.__init__-52"><a href="#TrinamicBoard.__init__-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.__init__()&#39;</span>
</span><span id="TrinamicBoard.__init__-53"><a href="#TrinamicBoard.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.__init__-54"><a href="#TrinamicBoard.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.__init__-55"><a href="#TrinamicBoard.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backlash</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># um of additional downlaod travel in z for drive hysterisis</span>
</span><span id="TrinamicBoard.__init__-56"><a href="#TrinamicBoard.__init__-56"><span class="linenos">56</span></a>
</span><span id="TrinamicBoard.__init__-57"><a href="#TrinamicBoard.__init__-57"><span class="linenos">57</span></a>        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
</span><span id="TrinamicBoard.__init__-58"><a href="#TrinamicBoard.__init__-58"><span class="linenos">58</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">vid</span> <span class="o">==</span> <span class="mh">0x2E8A</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">port</span><span class="o">.</span><span class="n">pid</span> <span class="o">==</span> <span class="mh">0x0005</span><span class="p">):</span>
</span><span id="TrinamicBoard.__init__-59"><a href="#TrinamicBoard.__init__-59"><span class="linenos">59</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Motor Controller at&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="TrinamicBoard.__init__-60"><a href="#TrinamicBoard.__init__-60"><span class="linenos">60</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span>
</span><span id="TrinamicBoard.__init__-61"><a href="#TrinamicBoard.__init__-61"><span class="linenos">61</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TrinamicBoard.__init__-62"><a href="#TrinamicBoard.__init__-62"><span class="linenos">62</span></a>                <span class="k">break</span>
</span><span id="TrinamicBoard.__init__-63"><a href="#TrinamicBoard.__init__-63"><span class="linenos">63</span></a>
</span><span id="TrinamicBoard.__init__-64"><a href="#TrinamicBoard.__init__-64"><span class="linenos">64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">115200</span>
</span><span id="TrinamicBoard.__init__-65"><a href="#TrinamicBoard.__init__-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bytesize</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">EIGHTBITS</span>
</span><span id="TrinamicBoard.__init__-66"><a href="#TrinamicBoard.__init__-66"><span class="linenos">66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">PARITY_NONE</span>
</span><span id="TrinamicBoard.__init__-67"><a href="#TrinamicBoard.__init__-67"><span class="linenos">67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopbits</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">STOPBITS_ONE</span>
</span><span id="TrinamicBoard.__init__-68"><a href="#TrinamicBoard.__init__-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># seconds</span>
</span><span id="TrinamicBoard.__init__-69"><a href="#TrinamicBoard.__init__-69"><span class="linenos">69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write_timeout</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># seconds</span>
</span><span id="TrinamicBoard.__init__-70"><a href="#TrinamicBoard.__init__-70"><span class="linenos">70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.__init__-71"><a href="#TrinamicBoard.__init__-71"><span class="linenos">71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.connect" class="classattr">
                                        <input id="TrinamicBoard.connect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.connect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.connect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.connect-77"><a href="#TrinamicBoard.connect-77"><span class="linenos">77</span></a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard.connect-78"><a href="#TrinamicBoard.connect-78"><span class="linenos">78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Try to connect to the motor controller based on the known VID/PID&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.connect-79"><a href="#TrinamicBoard.connect-79"><span class="linenos">79</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TrinamicBoard.connect-80"><a href="#TrinamicBoard.connect-80"><span class="linenos">80</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
</span><span id="TrinamicBoard.connect-81"><a href="#TrinamicBoard.connect-81"><span class="linenos">81</span></a>                                        <span class="n">baudrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baudrate</span><span class="p">,</span>
</span><span id="TrinamicBoard.connect-82"><a href="#TrinamicBoard.connect-82"><span class="linenos">82</span></a>                                        <span class="n">bytesize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bytesize</span><span class="p">,</span>
</span><span id="TrinamicBoard.connect-83"><a href="#TrinamicBoard.connect-83"><span class="linenos">83</span></a>                                        <span class="n">parity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parity</span><span class="p">,</span>
</span><span id="TrinamicBoard.connect-84"><a href="#TrinamicBoard.connect-84"><span class="linenos">84</span></a>                                        <span class="n">stopbits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stopbits</span><span class="p">,</span>
</span><span id="TrinamicBoard.connect-85"><a href="#TrinamicBoard.connect-85"><span class="linenos">85</span></a>                                        <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="TrinamicBoard.connect-86"><a href="#TrinamicBoard.connect-86"><span class="linenos">86</span></a>                                        <span class="n">write_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">write_timeout</span><span class="p">)</span>
</span><span id="TrinamicBoard.connect-87"><a href="#TrinamicBoard.connect-87"><span class="linenos">87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TrinamicBoard.connect-88"><a href="#TrinamicBoard.connect-88"><span class="linenos">88</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="TrinamicBoard.connect-89"><a href="#TrinamicBoard.connect-89"><span class="linenos">89</span></a>            
</span><span id="TrinamicBoard.connect-90"><a href="#TrinamicBoard.connect-90"><span class="linenos">90</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard.connect-91"><a href="#TrinamicBoard.connect-91"><span class="linenos">91</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.connect()</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">response</span>
</span><span id="TrinamicBoard.connect-92"><a href="#TrinamicBoard.connect-92"><span class="linenos">92</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TrinamicBoard.connect()</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
</span><span id="TrinamicBoard.connect-93"><a href="#TrinamicBoard.connect-93"><span class="linenos">93</span></a>
</span><span id="TrinamicBoard.connect-94"><a href="#TrinamicBoard.connect-94"><span class="linenos">94</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="TrinamicBoard.connect-95"><a href="#TrinamicBoard.connect-95"><span class="linenos">95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.connect-96"><a href="#TrinamicBoard.connect-96"><span class="linenos">96</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.connect() failed&#39;</span>
</span><span id="TrinamicBoard.connect-97"><a href="#TrinamicBoard.connect-97"><span class="linenos">97</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TrinamicBoard.connect() succeeded&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Try to connect to the motor controller based on the known VID/PID</p>
</div>


                            </div>
                            <div id="TrinamicBoard.exchange_command" class="classattr">
                                        <input id="TrinamicBoard.exchange_command-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exchange_command</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">command</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.exchange_command-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.exchange_command"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.exchange_command-102"><a href="#TrinamicBoard.exchange_command-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">exchange_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
</span><span id="TrinamicBoard.exchange_command-103"><a href="#TrinamicBoard.exchange_command-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Exchange command through serial to SPI to the Trinamic boards</span>
</span><span id="TrinamicBoard.exchange_command-104"><a href="#TrinamicBoard.exchange_command-104"><span class="linenos">104</span></a><span class="sd">        This should NOT be used in a script. It is intended for other functions to access&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.exchange_command-105"><a href="#TrinamicBoard.exchange_command-105"><span class="linenos">105</span></a>
</span><span id="TrinamicBoard.exchange_command-106"><a href="#TrinamicBoard.exchange_command-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="TrinamicBoard.exchange_command-107"><a href="#TrinamicBoard.exchange_command-107"><span class="linenos">107</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TrinamicBoard.exchange_command-108"><a href="#TrinamicBoard.exchange_command-108"><span class="linenos">108</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TrinamicBoard.exchange_command-109"><a href="#TrinamicBoard.exchange_command-109"><span class="linenos">109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</span><span id="TrinamicBoard.exchange_command-110"><a href="#TrinamicBoard.exchange_command-110"><span class="linenos">110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TrinamicBoard.exchange_command-111"><a href="#TrinamicBoard.exchange_command-111"><span class="linenos">111</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span><span id="TrinamicBoard.exchange_command-112"><a href="#TrinamicBoard.exchange_command-112"><span class="linenos">112</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="TrinamicBoard.exchange_command-113"><a href="#TrinamicBoard.exchange_command-113"><span class="linenos">113</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.exchange_command(&#39;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="TrinamicBoard.exchange_command-114"><a href="#TrinamicBoard.exchange_command-114"><span class="linenos">114</span></a>                <span class="k">return</span> <span class="n">response</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>                
</span><span id="TrinamicBoard.exchange_command-115"><a href="#TrinamicBoard.exchange_command-115"><span class="linenos">115</span></a>
</span><span id="TrinamicBoard.exchange_command-116"><a href="#TrinamicBoard.exchange_command-116"><span class="linenos">116</span></a>            <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialTimeoutException</span><span class="p">:</span>
</span><span id="TrinamicBoard.exchange_command-117"><a href="#TrinamicBoard.exchange_command-117"><span class="linenos">117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.exchange_command(&#39;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39;) Serial Timeout Occurred&#39;</span>
</span><span id="TrinamicBoard.exchange_command-118"><a href="#TrinamicBoard.exchange_command-118"><span class="linenos">118</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.exchange_command-119"><a href="#TrinamicBoard.exchange_command-119"><span class="linenos">119</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.exchange_command-120"><a href="#TrinamicBoard.exchange_command-120"><span class="linenos">120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span id="TrinamicBoard.exchange_command-121"><a href="#TrinamicBoard.exchange_command-121"><span class="linenos">121</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Exchange command through serial to SPI to the Trinamic boards
This should NOT be used in a script. It is intended for other functions to access</p>
</div>


                            </div>
                            <div id="TrinamicBoard.z_ustep2um" class="classattr">
                                        <input id="TrinamicBoard.z_ustep2um-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">z_ustep2um</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ustep</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.z_ustep2um-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.z_ustep2um"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.z_ustep2um-161"><a href="#TrinamicBoard.z_ustep2um-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">z_ustep2um</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="TrinamicBoard.z_ustep2um-162"><a href="#TrinamicBoard.z_ustep2um-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.z_ustep2um(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.z_ustep2um-163"><a href="#TrinamicBoard.z_ustep2um-163"><span class="linenos">163</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">0.00586</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># 0.00586 um/ustep Olympus Z</span>
</span><span id="TrinamicBoard.z_ustep2um-164"><a href="#TrinamicBoard.z_ustep2um-164"><span class="linenos">164</span></a>        <span class="k">return</span> <span class="n">um</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.z_um2ustep" class="classattr">
                                        <input id="TrinamicBoard.z_um2ustep-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">z_um2ustep</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">um</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.z_um2ustep-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.z_um2ustep"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.z_um2ustep-166"><a href="#TrinamicBoard.z_um2ustep-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">z_um2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard.z_um2ustep-167"><a href="#TrinamicBoard.z_um2ustep-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.z_um2ustep(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.z_um2ustep-168"><a href="#TrinamicBoard.z_um2ustep-168"><span class="linenos">168</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">0.00586</span> <span class="p">)</span> <span class="c1"># 0.00586 um/ustep Olympus Z</span>
</span><span id="TrinamicBoard.z_um2ustep-169"><a href="#TrinamicBoard.z_um2ustep-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.zhome" class="classattr">
                                        <input id="TrinamicBoard.zhome-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">zhome</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.zhome-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.zhome"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.zhome-171"><a href="#TrinamicBoard.zhome-171"><span class="linenos">171</span></a>    <span class="k">def</span> <span class="nf">zhome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard.zhome-172"><a href="#TrinamicBoard.zhome-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the objective &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.zhome-173"><a href="#TrinamicBoard.zhome-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.zhome()&#39;</span>            
</span><span id="TrinamicBoard.zhome-174"><a href="#TrinamicBoard.zhome-174"><span class="linenos">174</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.zhome-175"><a href="#TrinamicBoard.zhome-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;ZHOME&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Home the objective</p>
</div>


                            </div>
                            <div id="TrinamicBoard.xy_ustep2um" class="classattr">
                                        <input id="TrinamicBoard.xy_ustep2um-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xy_ustep2um</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ustep</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.xy_ustep2um-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.xy_ustep2um"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.xy_ustep2um-180"><a href="#TrinamicBoard.xy_ustep2um-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">xy_ustep2um</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="TrinamicBoard.xy_ustep2um-181"><a href="#TrinamicBoard.xy_ustep2um-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xy_ustep2um(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.xy_ustep2um-182"><a href="#TrinamicBoard.xy_ustep2um-182"><span class="linenos">182</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">0.0496</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># 0.0496 um/ustep</span>
</span><span id="TrinamicBoard.xy_ustep2um-183"><a href="#TrinamicBoard.xy_ustep2um-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">um</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.xy_um2ustep" class="classattr">
                                        <input id="TrinamicBoard.xy_um2ustep-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xy_um2ustep</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">um</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.xy_um2ustep-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.xy_um2ustep"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.xy_um2ustep-185"><a href="#TrinamicBoard.xy_um2ustep-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">xy_um2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard.xy_um2ustep-186"><a href="#TrinamicBoard.xy_um2ustep-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xy_um2ustep(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.xy_um2ustep-187"><a href="#TrinamicBoard.xy_um2ustep-187"><span class="linenos">187</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">0.0496</span><span class="p">)</span> <span class="c1"># 0.0496 um/ustep</span>
</span><span id="TrinamicBoard.xy_um2ustep-188"><a href="#TrinamicBoard.xy_um2ustep-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.xyhome" class="classattr">
                                        <input id="TrinamicBoard.xyhome-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xyhome</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.xyhome-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.xyhome"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.xyhome-190"><a href="#TrinamicBoard.xyhome-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">xyhome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard.xyhome-191"><a href="#TrinamicBoard.xyhome-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the stage which also homes the objective first &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.xyhome-192"><a href="#TrinamicBoard.xyhome-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.xyhome()&#39;</span>            
</span><span id="TrinamicBoard.xyhome-193"><a href="#TrinamicBoard.xyhome-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.xyhome-194"><a href="#TrinamicBoard.xyhome-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;HOME&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Home the stage which also homes the objective first</p>
</div>


                            </div>
                            <div id="TrinamicBoard.t_ustep2deg" class="classattr">
                                        <input id="TrinamicBoard.t_ustep2deg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">t_ustep2deg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ustep</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.t_ustep2deg-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.t_ustep2deg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.t_ustep2deg-199"><a href="#TrinamicBoard.t_ustep2deg-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">t_ustep2deg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ustep</span><span class="p">):</span>
</span><span id="TrinamicBoard.t_ustep2deg-200"><a href="#TrinamicBoard.t_ustep2deg-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.t_ustep2deg(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ustep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.t_ustep2deg-201"><a href="#TrinamicBoard.t_ustep2deg-201"><span class="linenos">201</span></a>        <span class="n">um</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">ustep</span> <span class="c1"># needs correct value</span>
</span><span id="TrinamicBoard.t_ustep2deg-202"><a href="#TrinamicBoard.t_ustep2deg-202"><span class="linenos">202</span></a>        <span class="k">return</span> <span class="n">um</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.t_deg2ustep" class="classattr">
                                        <input id="TrinamicBoard.t_deg2ustep-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">t_deg2ustep</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">um</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.t_deg2ustep-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.t_deg2ustep"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.t_deg2ustep-204"><a href="#TrinamicBoard.t_deg2ustep-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">t_deg2ustep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard.t_deg2ustep-205"><a href="#TrinamicBoard.t_deg2ustep-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.t_ustep2deg(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.t_deg2ustep-206"><a href="#TrinamicBoard.t_deg2ustep-206"><span class="linenos">206</span></a>        <span class="n">ustep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">um</span> <span class="o">/</span> <span class="mf">1.</span><span class="p">)</span> <span class="c1"># needs correct value</span>
</span><span id="TrinamicBoard.t_deg2ustep-207"><a href="#TrinamicBoard.t_deg2ustep-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="n">ustep</span>
</span></pre></div>


    

                            </div>
                            <div id="TrinamicBoard.thome" class="classattr">
                                        <input id="TrinamicBoard.thome-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">thome</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.thome-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.thome"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.thome-209"><a href="#TrinamicBoard.thome-209"><span class="linenos">209</span></a>    <span class="k">def</span> <span class="nf">thome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TrinamicBoard.thome-210"><a href="#TrinamicBoard.thome-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Home the turret, not yet functional in hardware&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.thome-211"><a href="#TrinamicBoard.thome-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.thome()&#39;</span>            
</span><span id="TrinamicBoard.thome-212"><a href="#TrinamicBoard.thome-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.thome-213"><a href="#TrinamicBoard.thome-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;THOME&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Home the turret, not yet functional in hardware</p>
</div>


                            </div>
                            <div id="TrinamicBoard.tmove" class="classattr">
                                        <input id="TrinamicBoard.tmove-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tmove</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">degrees</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.tmove-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.tmove"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.tmove-215"><a href="#TrinamicBoard.tmove-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">tmove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">):</span>
</span><span id="TrinamicBoard.tmove-216"><a href="#TrinamicBoard.tmove-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move the turret, not yet functional in hardware&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.tmove-217"><a href="#TrinamicBoard.tmove-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.thome()&#39;</span>
</span><span id="TrinamicBoard.tmove-218"><a href="#TrinamicBoard.tmove-218"><span class="linenos">218</span></a>        <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_deg2ustep</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
</span><span id="TrinamicBoard.tmove-219"><a href="#TrinamicBoard.tmove-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.tmove-220"><a href="#TrinamicBoard.tmove-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Move the turret, not yet functional in hardware</p>
</div>


                            </div>
                            <div id="TrinamicBoard.move" class="classattr">
                                        <input id="TrinamicBoard.move-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">move</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span>, </span><span class="param"><span class="n">steps</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.move-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.move"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.move-226"><a href="#TrinamicBoard.move-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
</span><span id="TrinamicBoard.move-227"><a href="#TrinamicBoard.move-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move the axis to an absolute position (in usteps)</span>
</span><span id="TrinamicBoard.move-228"><a href="#TrinamicBoard.move-228"><span class="linenos">228</span></a><span class="sd">        compared to Home &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.move-229"><a href="#TrinamicBoard.move-229"><span class="linenos">229</span></a>
</span><span id="TrinamicBoard.move-230"><a href="#TrinamicBoard.move-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard.move-231"><a href="#TrinamicBoard.move-231"><span class="linenos">231</span></a>            <span class="n">steps</span> <span class="o">+=</span> <span class="mh">0x100000000</span> <span class="c1"># twos compliment</span>
</span><span id="TrinamicBoard.move-232"><a href="#TrinamicBoard.move-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;TARGET_W&#39;</span> <span class="o">+</span> <span class="n">axis</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">steps</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Move the axis to an absolute position (in usteps)
compared to Home</p>
</div>


                            </div>
                            <div id="TrinamicBoard.target_pos" class="classattr">
                                        <input id="TrinamicBoard.target_pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">target_pos</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.target_pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.target_pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.target_pos-235"><a href="#TrinamicBoard.target_pos-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">target_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard.target_pos-236"><a href="#TrinamicBoard.target_pos-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the target position of an axis&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.target_pos-237"><a href="#TrinamicBoard.target_pos-237"><span class="linenos">237</span></a>
</span><span id="TrinamicBoard.target_pos-238"><a href="#TrinamicBoard.target_pos-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_pos-239"><a href="#TrinamicBoard.target_pos-239"><span class="linenos">239</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;TARGET_R&#39;</span> <span class="o">+</span> <span class="n">axis</span> <span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard.target_pos-240"><a href="#TrinamicBoard.target_pos-240"><span class="linenos">240</span></a>
</span><span id="TrinamicBoard.target_pos-241"><a href="#TrinamicBoard.target_pos-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_pos-242"><a href="#TrinamicBoard.target_pos-242"><span class="linenos">242</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.target_pos-243"><a href="#TrinamicBoard.target_pos-243"><span class="linenos">243</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_pos-244"><a href="#TrinamicBoard.target_pos-244"><span class="linenos">244</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.target_pos-245"><a href="#TrinamicBoard.target_pos-245"><span class="linenos">245</span></a>
</span><span id="TrinamicBoard.target_pos-246"><a href="#TrinamicBoard.target_pos-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>            
</span><span id="TrinamicBoard.target_pos-247"><a href="#TrinamicBoard.target_pos-247"><span class="linenos">247</span></a>            <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard.target_pos-248"><a href="#TrinamicBoard.target_pos-248"><span class="linenos">248</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_pos-249"><a href="#TrinamicBoard.target_pos-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard.target_pos-250"><a href="#TrinamicBoard.target_pos-250"><span class="linenos">250</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Get the target position of an axis</p>
</div>


                            </div>
                            <div id="TrinamicBoard.current_pos" class="classattr">
                                        <input id="TrinamicBoard.current_pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">current_pos</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.current_pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.current_pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.current_pos-253"><a href="#TrinamicBoard.current_pos-253"><span class="linenos">253</span></a>    <span class="k">def</span> <span class="nf">current_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard.current_pos-254"><a href="#TrinamicBoard.current_pos-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current position (in um) of axis&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.current_pos-255"><a href="#TrinamicBoard.current_pos-255"><span class="linenos">255</span></a>        
</span><span id="TrinamicBoard.current_pos-256"><a href="#TrinamicBoard.current_pos-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.current_pos-257"><a href="#TrinamicBoard.current_pos-257"><span class="linenos">257</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;ACTUAL_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard.current_pos-258"><a href="#TrinamicBoard.current_pos-258"><span class="linenos">258</span></a>
</span><span id="TrinamicBoard.current_pos-259"><a href="#TrinamicBoard.current_pos-259"><span class="linenos">259</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard.current_pos-260"><a href="#TrinamicBoard.current_pos-260"><span class="linenos">260</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.current_pos-261"><a href="#TrinamicBoard.current_pos-261"><span class="linenos">261</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.current_pos-262"><a href="#TrinamicBoard.current_pos-262"><span class="linenos">262</span></a>                <span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_ustep2um</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.current_pos-263"><a href="#TrinamicBoard.current_pos-263"><span class="linenos">263</span></a>
</span><span id="TrinamicBoard.current_pos-264"><a href="#TrinamicBoard.current_pos-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.current_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>            
</span><span id="TrinamicBoard.current_pos-265"><a href="#TrinamicBoard.current_pos-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="n">um</span>
</span><span id="TrinamicBoard.current_pos-266"><a href="#TrinamicBoard.current_pos-266"><span class="linenos">266</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.current_pos-267"><a href="#TrinamicBoard.current_pos-267"><span class="linenos">267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.current_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard.current_pos-268"><a href="#TrinamicBoard.current_pos-268"><span class="linenos">268</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Get current position (in um) of axis</p>
</div>


                            </div>
                            <div id="TrinamicBoard.move_abs_pos" class="classattr">
                                        <input id="TrinamicBoard.move_abs_pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">move_abs_pos</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span>, </span><span class="param"><span class="n">pos</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.move_abs_pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.move_abs_pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.move_abs_pos-271"><a href="#TrinamicBoard.move_abs_pos-271"><span class="linenos">271</span></a>    <span class="k">def</span> <span class="nf">move_abs_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
</span><span id="TrinamicBoard.move_abs_pos-272"><a href="#TrinamicBoard.move_abs_pos-272"><span class="linenos">272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move to absolute position (in um) of axis&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.move_abs_pos-273"><a href="#TrinamicBoard.move_abs_pos-273"><span class="linenos">273</span></a>
</span><span id="TrinamicBoard.move_abs_pos-274"><a href="#TrinamicBoard.move_abs_pos-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-275"><a href="#TrinamicBoard.move_abs_pos-275"><span class="linenos">275</span></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="c1"># Z bound between 0 to 14mm</span>
</span><span id="TrinamicBoard.move_abs_pos-276"><a href="#TrinamicBoard.move_abs_pos-276"><span class="linenos">276</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-277"><a href="#TrinamicBoard.move_abs_pos-277"><span class="linenos">277</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="TrinamicBoard.move_abs_pos-278"><a href="#TrinamicBoard.move_abs_pos-278"><span class="linenos">278</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">14000</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-279"><a href="#TrinamicBoard.move_abs_pos-279"><span class="linenos">279</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">14000.</span>
</span><span id="TrinamicBoard.move_abs_pos-280"><a href="#TrinamicBoard.move_abs_pos-280"><span class="linenos">280</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-281"><a href="#TrinamicBoard.move_abs_pos-281"><span class="linenos">281</span></a>            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="c1"># X bound 0 to 120mm</span>
</span><span id="TrinamicBoard.move_abs_pos-282"><a href="#TrinamicBoard.move_abs_pos-282"><span class="linenos">282</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-283"><a href="#TrinamicBoard.move_abs_pos-283"><span class="linenos">283</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="TrinamicBoard.move_abs_pos-284"><a href="#TrinamicBoard.move_abs_pos-284"><span class="linenos">284</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">120000</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-285"><a href="#TrinamicBoard.move_abs_pos-285"><span class="linenos">285</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">120000.</span>
</span><span id="TrinamicBoard.move_abs_pos-286"><a href="#TrinamicBoard.move_abs_pos-286"><span class="linenos">286</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-287"><a href="#TrinamicBoard.move_abs_pos-287"><span class="linenos">287</span></a>            <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="c1"># y bound 0 to 80mm</span>
</span><span id="TrinamicBoard.move_abs_pos-288"><a href="#TrinamicBoard.move_abs_pos-288"><span class="linenos">288</span></a>                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-289"><a href="#TrinamicBoard.move_abs_pos-289"><span class="linenos">289</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.</span>
</span><span id="TrinamicBoard.move_abs_pos-290"><a href="#TrinamicBoard.move_abs_pos-290"><span class="linenos">290</span></a>                <span class="k">elif</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">80000</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-291"><a href="#TrinamicBoard.move_abs_pos-291"><span class="linenos">291</span></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="mf">80000.</span>
</span><span id="TrinamicBoard.move_abs_pos-292"><a href="#TrinamicBoard.move_abs_pos-292"><span class="linenos">292</span></a>                <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-293"><a href="#TrinamicBoard.move_abs_pos-293"><span class="linenos">293</span></a>
</span><span id="TrinamicBoard.move_abs_pos-294"><a href="#TrinamicBoard.move_abs_pos-294"><span class="linenos">294</span></a>            <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="c1"># perform overshoot to always come from one direction</span>
</span><span id="TrinamicBoard.move_abs_pos-295"><a href="#TrinamicBoard.move_abs_pos-295"><span class="linenos">295</span></a>                <span class="c1"># get current position</span>
</span><span id="TrinamicBoard.move_abs_pos-296"><a href="#TrinamicBoard.move_abs_pos-296"><span class="linenos">296</span></a>                <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-297"><a href="#TrinamicBoard.move_abs_pos-297"><span class="linenos">297</span></a>
</span><span id="TrinamicBoard.move_abs_pos-298"><a href="#TrinamicBoard.move_abs_pos-298"><span class="linenos">298</span></a>                <span class="c1"># if the current position is above the new target position</span>
</span><span id="TrinamicBoard.move_abs_pos-299"><a href="#TrinamicBoard.move_abs_pos-299"><span class="linenos">299</span></a>                <span class="k">if</span> <span class="n">current</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-300"><a href="#TrinamicBoard.move_abs_pos-300"><span class="linenos">300</span></a>                    <span class="c1"># In process of overshoot</span>
</span><span id="TrinamicBoard.move_abs_pos-301"><a href="#TrinamicBoard.move_abs_pos-301"><span class="linenos">301</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TrinamicBoard.move_abs_pos-302"><a href="#TrinamicBoard.move_abs_pos-302"><span class="linenos">302</span></a>                    <span class="c1"># First overshoot downwards</span>
</span><span id="TrinamicBoard.move_abs_pos-303"><a href="#TrinamicBoard.move_abs_pos-303"><span class="linenos">303</span></a>                    <span class="n">overshoot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_um2ustep</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">backlash</span><span class="p">)</span> <span class="c1"># target minus backlash</span>
</span><span id="TrinamicBoard.move_abs_pos-304"><a href="#TrinamicBoard.move_abs_pos-304"><span class="linenos">304</span></a>                    <span class="n">overshoot</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">overshoot</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-305"><a href="#TrinamicBoard.move_abs_pos-305"><span class="linenos">305</span></a>                    <span class="c1">#self.SPI_write (self.chip_pin[axis], self.write_target[axis], overshoot)</span>
</span><span id="TrinamicBoard.move_abs_pos-306"><a href="#TrinamicBoard.move_abs_pos-306"><span class="linenos">306</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">overshoot</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-307"><a href="#TrinamicBoard.move_abs_pos-307"><span class="linenos">307</span></a>                    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_status</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">):</span>
</span><span id="TrinamicBoard.move_abs_pos-308"><a href="#TrinamicBoard.move_abs_pos-308"><span class="linenos">308</span></a>                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-309"><a href="#TrinamicBoard.move_abs_pos-309"><span class="linenos">309</span></a>                    <span class="c1"># complete overshoot</span>
</span><span id="TrinamicBoard.move_abs_pos-310"><a href="#TrinamicBoard.move_abs_pos-310"><span class="linenos">310</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">overshoot</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.move_abs_pos-311"><a href="#TrinamicBoard.move_abs_pos-311"><span class="linenos">311</span></a>
</span><span id="TrinamicBoard.move_abs_pos-312"><a href="#TrinamicBoard.move_abs_pos-312"><span class="linenos">312</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_abs_pos-313"><a href="#TrinamicBoard.move_abs_pos-313"><span class="linenos">313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_abs_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="TrinamicBoard.move_abs_pos-314"><a href="#TrinamicBoard.move_abs_pos-314"><span class="linenos">314</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_abs_pos-315"><a href="#TrinamicBoard.move_abs_pos-315"><span class="linenos">315</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_abs_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>
</span></pre></div>


            <div class="docstring"><p>Move to absolute position (in um) of axis</p>
</div>


                            </div>
                            <div id="TrinamicBoard.move_rel_pos" class="classattr">
                                        <input id="TrinamicBoard.move_rel_pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">move_rel_pos</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span>, </span><span class="param"><span class="n">um</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.move_rel_pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.move_rel_pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.move_rel_pos-318"><a href="#TrinamicBoard.move_rel_pos-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">move_rel_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">um</span><span class="p">):</span>
</span><span id="TrinamicBoard.move_rel_pos-319"><a href="#TrinamicBoard.move_rel_pos-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Move by relative distance (in um) of axis &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.move_rel_pos-320"><a href="#TrinamicBoard.move_rel_pos-320"><span class="linenos">320</span></a>
</span><span id="TrinamicBoard.move_rel_pos-321"><a href="#TrinamicBoard.move_rel_pos-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_rel_pos-322"><a href="#TrinamicBoard.move_rel_pos-322"><span class="linenos">322</span></a>            <span class="c1"># Read target position in um</span>
</span><span id="TrinamicBoard.move_rel_pos-323"><a href="#TrinamicBoard.move_rel_pos-323"><span class="linenos">323</span></a>            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_pos</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_rel_pos-324"><a href="#TrinamicBoard.move_rel_pos-324"><span class="linenos">324</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">move_abs_pos</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">pos</span><span class="o">+</span><span class="n">um</span><span class="p">)</span>
</span><span id="TrinamicBoard.move_rel_pos-325"><a href="#TrinamicBoard.move_rel_pos-325"><span class="linenos">325</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_rel_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) succeeded&#39;</span>
</span><span id="TrinamicBoard.move_rel_pos-326"><a href="#TrinamicBoard.move_rel_pos-326"><span class="linenos">326</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.move_rel_pos-327"><a href="#TrinamicBoard.move_rel_pos-327"><span class="linenos">327</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.move_rel_pos(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">um</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>
</span></pre></div>


            <div class="docstring"><p>Move by relative distance (in um) of axis</p>
</div>


                            </div>
                            <div id="TrinamicBoard.home_status" class="classattr">
                                        <input id="TrinamicBoard.home_status-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">home_status</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.home_status-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.home_status"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.home_status-334"><a href="#TrinamicBoard.home_status-334"><span class="linenos">334</span></a>    <span class="k">def</span> <span class="nf">home_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard.home_status-335"><a href="#TrinamicBoard.home_status-335"><span class="linenos">335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Return True if axis is in home position&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.home_status-336"><a href="#TrinamicBoard.home_status-336"><span class="linenos">336</span></a>
</span><span id="TrinamicBoard.home_status-337"><a href="#TrinamicBoard.home_status-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.home_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>            
</span><span id="TrinamicBoard.home_status-338"><a href="#TrinamicBoard.home_status-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.home_status-339"><a href="#TrinamicBoard.home_status-339"><span class="linenos">339</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard.home_status-340"><a href="#TrinamicBoard.home_status-340"><span class="linenos">340</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="TrinamicBoard.home_status-341"><a href="#TrinamicBoard.home_status-341"><span class="linenos">341</span></a>
</span><span id="TrinamicBoard.home_status-342"><a href="#TrinamicBoard.home_status-342"><span class="linenos">342</span></a>            <span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard.home_status-343"><a href="#TrinamicBoard.home_status-343"><span class="linenos">343</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="TrinamicBoard.home_status-344"><a href="#TrinamicBoard.home_status-344"><span class="linenos">344</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.home_status-345"><a href="#TrinamicBoard.home_status-345"><span class="linenos">345</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.home_status-346"><a href="#TrinamicBoard.home_status-346"><span class="linenos">346</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.home_status-347"><a href="#TrinamicBoard.home_status-347"><span class="linenos">347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.home_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard.home_status-348"><a href="#TrinamicBoard.home_status-348"><span class="linenos">348</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if axis is in home position</p>
</div>


                            </div>
                            <div id="TrinamicBoard.target_status" class="classattr">
                                        <input id="TrinamicBoard.target_status-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">target_status</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.target_status-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.target_status"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.target_status-351"><a href="#TrinamicBoard.target_status-351"><span class="linenos">351</span></a>    <span class="k">def</span> <span class="nf">target_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard.target_status-352"><a href="#TrinamicBoard.target_status-352"><span class="linenos">352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Return True if axis is at target position&quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.target_status-353"><a href="#TrinamicBoard.target_status-353"><span class="linenos">353</span></a>
</span><span id="TrinamicBoard.target_status-354"><a href="#TrinamicBoard.target_status-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.target_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>  
</span><span id="TrinamicBoard.target_status-355"><a href="#TrinamicBoard.target_status-355"><span class="linenos">355</span></a>        
</span><span id="TrinamicBoard.target_status-356"><a href="#TrinamicBoard.target_status-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_status-357"><a href="#TrinamicBoard.target_status-357"><span class="linenos">357</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard.target_status-358"><a href="#TrinamicBoard.target_status-358"><span class="linenos">358</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="TrinamicBoard.target_status-359"><a href="#TrinamicBoard.target_status-359"><span class="linenos">359</span></a>
</span><span id="TrinamicBoard.target_status-360"><a href="#TrinamicBoard.target_status-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">bits</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_status-361"><a href="#TrinamicBoard.target_status-361"><span class="linenos">361</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="TrinamicBoard.target_status-362"><a href="#TrinamicBoard.target_status-362"><span class="linenos">362</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_status-363"><a href="#TrinamicBoard.target_status-363"><span class="linenos">363</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="TrinamicBoard.target_status-364"><a href="#TrinamicBoard.target_status-364"><span class="linenos">364</span></a>  
</span><span id="TrinamicBoard.target_status-365"><a href="#TrinamicBoard.target_status-365"><span class="linenos">365</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.target_status-366"><a href="#TrinamicBoard.target_status-366"><span class="linenos">366</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.get_limit_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard.target_status-367"><a href="#TrinamicBoard.target_status-367"><span class="linenos">367</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if axis is at target position</p>
</div>


                            </div>
                            <div id="TrinamicBoard.reference_status" class="classattr">
                                        <input id="TrinamicBoard.reference_status-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reference_status</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axis</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TrinamicBoard.reference_status-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TrinamicBoard.reference_status"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TrinamicBoard.reference_status-371"><a href="#TrinamicBoard.reference_status-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">reference_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="TrinamicBoard.reference_status-372"><a href="#TrinamicBoard.reference_status-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Get all reference status register bits as 32 character string (32-&gt; 0) &quot;&quot;&quot;</span>
</span><span id="TrinamicBoard.reference_status-373"><a href="#TrinamicBoard.reference_status-373"><span class="linenos">373</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">found</span><span class="p">:</span>
</span><span id="TrinamicBoard.reference_status-374"><a href="#TrinamicBoard.reference_status-374"><span class="linenos">374</span></a>
</span><span id="TrinamicBoard.reference_status-375"><a href="#TrinamicBoard.reference_status-375"><span class="linenos">375</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchange_command</span><span class="p">(</span><span class="s1">&#39;STATUS_R&#39;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">)</span> <span class="p">)</span>
</span><span id="TrinamicBoard.reference_status-376"><a href="#TrinamicBoard.reference_status-376"><span class="linenos">376</span></a>            <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span><span id="TrinamicBoard.reference_status-377"><a href="#TrinamicBoard.reference_status-377"><span class="linenos">377</span></a>
</span><span id="TrinamicBoard.reference_status-378"><a href="#TrinamicBoard.reference_status-378"><span class="linenos">378</span></a>            <span class="c1"># data is an integer that represents 4 bytes, or 32 bits,</span>
</span><span id="TrinamicBoard.reference_status-379"><a href="#TrinamicBoard.reference_status-379"><span class="linenos">379</span></a>            <span class="c1"># largest bit first</span>
</span><span id="TrinamicBoard.reference_status-380"><a href="#TrinamicBoard.reference_status-380"><span class="linenos">380</span></a><span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="TrinamicBoard.reference_status-381"><a href="#TrinamicBoard.reference_status-381"><span class="linenos">381</span></a><span class="sd">            bit: 33222222222211111111110000000000</span>
</span><span id="TrinamicBoard.reference_status-382"><a href="#TrinamicBoard.reference_status-382"><span class="linenos">382</span></a><span class="sd">            bit: 10987654321098765432109876543210</span>
</span><span id="TrinamicBoard.reference_status-383"><a href="#TrinamicBoard.reference_status-383"><span class="linenos">383</span></a><span class="sd">            bit: ----------------------*-------**</span>
</span><span id="TrinamicBoard.reference_status-384"><a href="#TrinamicBoard.reference_status-384"><span class="linenos">384</span></a><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="TrinamicBoard.reference_status-385"><a href="#TrinamicBoard.reference_status-385"><span class="linenos">385</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="TrinamicBoard.reference_status-386"><a href="#TrinamicBoard.reference_status-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="TrinamicBoard.reference_status-387"><a href="#TrinamicBoard.reference_status-387"><span class="linenos">387</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TrinamicBoard.reference_status-388"><a href="#TrinamicBoard.reference_status-388"><span class="linenos">388</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;TrinamicBoard.reference_status(&#39;</span><span class="o">+</span><span class="n">axis</span><span class="o">+</span><span class="s1">&#39;) inactive&#39;</span>            
</span><span id="TrinamicBoard.reference_status-389"><a href="#TrinamicBoard.reference_status-389"><span class="linenos">389</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Get all reference status register bits as 32 character string (32-> 0)</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>